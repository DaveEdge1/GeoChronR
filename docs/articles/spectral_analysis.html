<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Spectral estimation with and without age uncertainties • geoChronR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="Spectral estimation with and without age uncertainties">
<meta property="og:description" content="geoChronR">
<meta property="og:image" content="https://nickmckay.github.io/geoChronR/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">geoChronR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="divider">
    <li class="dropdown-header">Getting Started With geoChronR</li>
    <li>
      <a href="../articles/Introduction.html">Introduction to geoChronR</a>
    </li>
    <li>
      <a href="../articles/correlation.html">Ensemble Correlation</a>
    </li>
    <li>
      <a href="../articles/regression.html">Ensemble Regression</a>
    </li>
    <li>
      <a href="../articles/spectral_analysis.html">Spectral Analysis</a>
    </li>
    <li>
      <a href="../articles/PCA.html">Ensemble Principal Components Analysis</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Tutorials highlighting additional geoChronR use cases</li>
    <li>
      <a href="../articles/oxCal.html">Introduction to oxCal in geoChronR</a>
    </li>
    <li>
      <a href="../articles/PlotTimeseriesStack.html">Plot a stack of timeseries</a>
    </li>
    <li>
      <a href="../articles/TsFilteringAndMapping.html">Dataset filtering and mapping (with iso2k)</a>
    </li>
    <li>
      <a href="../articles/tidyIso2k.html">Tidy filtering and mapping (with tidyverse &amp; iso2k)</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/nickmckay/geoChronR/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Spectral estimation with and without age uncertainties</h1>
                        <h4 class="author">Julien Emile-Geay</h4>
            
            <h4 class="date">2020-10-12</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/nickmckay/geoChronR/blob/master/vignettes/spectral_analysis.Rmd"><code>vignettes/spectral_analysis.Rmd</code></a></small>
      <div class="hidden name"><code>spectral_analysis.Rmd</code></div>

    </div>

    
    
<div id="table-of-contents" class="section level1">
<h1 class="hasAnchor">
<a href="#table-of-contents" class="anchor"></a>Table of contents</h1>
<ol style="list-style-type: decimal">
<li><a href="Introduction.html">Introduction to geoChronR</a></li>
<li><a href="correlation.html">Age-uncertain correlation</a></li>
<li><a href="regression.html">Age-uncertain regression and calibration-in-time</a></li>
<li><a href="spectral.html"><strong>Age-uncertain spectral analysis</strong></a></li>
<li><a href="pca.html">Age-uncertain PCA analysis</a></li>
</ol>
</div>
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>In this notebook we demonstrate how to use the spectral analysis features of GeoChronR using the “ODP846” record described in:</p>
<ul>
<li>Mix, A. C., J. Le, and N. J. Shackleton (1995a), Benthic foraminiferal stable isotope stratigraphy from Site 846: 0–1.8 Ma, Proc. Ocean Drill. Program Sci. Results, 138, 839–847.</li>
<li>Shackleton, N. J. (1995), New data on the evolution of Pliocene climate variability, in Paleoclimate and Evolution, With Emphasis on Human Origins, edited by E. S. Vrba et al., pp. 242-248, Yale Univ. Press, New Haven, CT.</li>
</ul>
<p>The data were aligned to the Benthic Stack of <a href="https://agupubs.onlinelibrary.wiley.com/doi/abs/10.1029/2004PA001071">Lisiecki &amp; Raymo (2005)</a> using the <a href="https://agupubs.onlinelibrary.wiley.com/doi/full/10.1002/2014PA002713">HMM-Match</a> algorithm <a href="https://agupubs.onlinelibrary.wiley.com/doi/abs/10.1002/2016PA003057">(Khider et al, 2017)</a>. The latter is a probabilistic method that generates an ensemble of 1000 possible age models compatible with the chronostratigraphic constraints.</p>
<p>We first remotely load the data using the LiPD utilities. Depending on your connectivity, this may take a minute as the file is fairly large (2.6Mb).</p>
<div class="sourceCode" id="cb1"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="kw">lipdR</span>) <span class="co"># to load the file</span>
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="kw"><a href="https://github.com/nickmckay/geoChronR">geoChronR</a></span>) <span class="co"># to analyze it</span>
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="kw"><a href="http://github.com/jrnold/ggthemes">ggthemes</a></span>) <span class="co"># to define plotting theme</span>
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="kw"><a href="http://ggplot2.tidyverse.org">ggplot2</a></span>)  <span class="co"># to plot</span>

<span class="kw">I</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lipdR/man/readLipd.html">readLipd</a></span>(<span class="st">"http://lipdverse.org/geoChronR-examples/ODP846.Lawrence.2006.lpd"</span>)
</pre></div>
<p>Now let us take a first look at the median age model:</p>
<div class="sourceCode" id="cb2"><pre class="downlit">
<span class="kw">d18O</span> <span class="op">=</span>  <span class="kw">I</span><span class="op">$</span><span class="kw">chronData</span>[[<span class="fl">1</span>]]<span class="op">$</span><span class="kw">model</span>[[<span class="fl">1</span>]]<span class="op">$</span><span class="kw">summaryTable</span>[[<span class="fl">1</span>]]<span class="op">$</span><span class="kw">d180</span><span class="op">$</span><span class="kw">values</span>
<span class="kw">t.med</span> <span class="op">&lt;-</span> <span class="kw">I</span><span class="op">$</span><span class="kw">chronData</span>[[<span class="fl">1</span>]]<span class="op">$</span><span class="kw">model</span>[[<span class="fl">1</span>]]<span class="op">$</span><span class="kw">summaryTable</span>[[<span class="fl">1</span>]]<span class="op">$</span><span class="kw">median</span><span class="op">$</span><span class="kw">values</span>
<span class="kw">L</span> <span class="op">&lt;-</span> <span class="kw">geoChronR</span>::<span class="fu"><a href="../reference/mapAgeEnsembleToPaleoData.html">mapAgeEnsembleToPaleoData</a></span>(<span class="kw">I</span>,paleo.meas.table.num = <span class="fl">1</span>)
<span class="kw">age</span> <span class="op">=</span> <span class="kw">geoChronR</span>::<span class="fu"><a href="../reference/selectData.html">selectData</a></span>(<span class="kw">L</span>,<span class="st">"ageEnsemble"</span>,meas.table.num = <span class="fl">1</span>)
<span class="kw">temp</span> <span class="op">=</span> <span class="kw">geoChronR</span>::<span class="fu"><a href="../reference/selectData.html">selectData</a></span>(<span class="kw">L</span>,<span class="st">"temp muller"</span>,meas.table.num = <span class="fl">1</span>)
<span class="fu"><a href="../reference/plotTimeseriesEnsRibbons.html">plotTimeseriesEnsRibbons</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(),X=<span class="kw">age</span>,Y=<span class="kw">temp</span>,color.low=<span class="st">"orchid"</span>,color.high=<span class="st">"darkorange3"</span>,color.line=<span class="st">"orange"</span>,line.width=<span class="fl">0.5</span>,alp=<span class="fl">0.3</span>) <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_reverse</a></span>() <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/ggthemes/man/theme_hc.html">theme_hc</a></span>(style = <span class="st">"darkunica"</span>)
</pre></div>
<p><img src="spectral_analysis_files/figure-html/unnamed-chunk-2-1.png" width="768"></p>
<p>This paleoclimate record features:</p>
<ul>
<li>a long-term cooling trend (<span class="math inline">\(\delta^{18}\mathrm{O}\)</span> gets more positive over time) characteristic of late Neogene and Quaternary.</li>
<li>some quasi-periodic oscillations (the legendary <a href="https://www.ncdc.noaa.gov/abrupt-climate-change/Glacial-Interglacial%20Cycles">Pleistocene Ice Ages</a>)</li>
<li>nonstationary behavior, related to the well-known mid-Pleistocene transition from a “41k world” to a “100k world” somewhere around 0.8 Ma <a href="https://agupubs.onlinelibrary.wiley.com/doi/pdf/10.1029/2000RG000091">(Paillard, 2001)</a>.</li>
</ul>
<p>To keep things simple and lower computational cost, let’s focus on the last million years, and use the median age model. Now, a standard assumption of spectral analysis is that data are evenly spaced in time. In real-world paleo timeseries this is seldom the case. Let’s look at the distribution of time increments in this particular core, as contrained by this tuned age model:</p>
<div class="sourceCode" id="cb3"><pre class="downlit">
<span class="kw">age.median</span> <span class="op">=</span> <span class="kw">matrixStats</span>::<span class="fu"><a href="https://rdrr.io/pkg/matrixStats/man/rowQuantiles.html">rowQuantiles</a></span>(<span class="kw">age</span><span class="op">$</span><span class="kw">values</span>,probs = <span class="fl">0.5</span>)
<span class="kw">temp.median</span> <span class="op">=</span> <span class="kw">matrixStats</span>::<span class="fu"><a href="https://rdrr.io/pkg/matrixStats/man/rowQuantiles.html">rowQuantiles</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span>(<span class="kw">temp</span><span class="op">$</span><span class="kw">values</span>),probs = <span class="fl">0.5</span>)
<span class="kw">t</span> <span class="op">&lt;-</span><span class="kw">age.median</span>[<span class="kw">age.median</span> <span class="op">&lt;</span> <span class="fl">1000</span>]
<span class="kw">X</span> <span class="op">&lt;-</span> <span class="kw">temp.median</span>[<span class="kw">age.median</span> <span class="op">&lt;</span> <span class="fl">1000</span>]
<span class="kw">X</span> <span class="op">&lt;-</span> <span class="kw">X</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="kw">X</span>)
<span class="co">#dfs = dplyr::filter(df,t&lt;=1000)</span>
<span class="kw">dt</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diff.html">diff</a></span>(<span class="kw">t</span>)
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>() <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">xlim</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>,<span class="fl">10</span>)) <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(x=<span class="kw">dt</span>,y = <span class="kw">..density..</span>), bins = <span class="fl">25</span>, ,alpha = <span class="fl">0.8</span>, fill = <span class="st">"orange"</span>) <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span>(<span class="st">"Distribution of time intervals"</span>) <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/ggthemes/man/theme_hc.html">theme_hc</a></span>(style = <span class="st">"darkunica"</span>) <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span>(<span class="kw">Delta</span><span class="op">*</span><span class="st">"t"</span>))
</pre></div>
<p><img src="spectral_analysis_files/figure-html/unnamed-chunk-3-1.png" width="768"></p>
<p>We see that over the past 1 Ma, the time increments (<span class="math inline">\(\Delta t\)</span>) are sharply peaked around 2 ka, but they range from 0 to about 7.5 ka. For now, let us assume that the time axis, albeit uneven, is well-known (no uncertainty). ## Time-certain spectral analysis From this point there are two ways to proceed: 1) use methods that explictly deal with unevenly-spaced data, or 2) interpolate to a regular grid and apply standard methods. In the first case, we could use the <em>Lomb-Scargle periodogram</em> or rather its version tailored for paleoclimate data, <a href="https://www.nonlin-processes-geophys.net/16/43/2009/">REDFIT</a>. In the second case, we can interpolate and use a method tailored to evenly-spaced data.</p>
<div id="lomb-scargle-periodogram" class="section level3">
<h3 class="hasAnchor">
<a href="#lomb-scargle-periodogram" class="anchor"></a>Lomb-Scargle periodogram</h3>
<p>This is a very standard method implemented in many packages. For a review, see <a href="https://iopscience.iop.org/article/10.3847/1538-4365/aab766/meta">VanderPlas (2018)</a>. There are several ways to implement Lomb-Scargle. geoChronR does this via the <a href="https://www.rdocumentation.org/packages/lomb">lomb</a> package.</p>
<p>To establish significance, we have a few choices. We re-use Stephen Meyer’s excellent <a href="https://www.rdocumentation.org/packages/astrochron">astrochron</a> package for this purpose, as it implements the methods described in <a href="https://agupubs.onlinelibrary.wiley.com/doi/full/10.1029/2012PA002307">Meyers, (2012)</a>. Several nulls could be chosen here, and we focus first on a power-law, characteristic of many paleoclimate records (e.g. <a href="https://www.pnas.org/content/116/18/8728.short">Zhu et al, 2019</a>).</p>
<div class="sourceCode" id="cb4"><pre class="downlit">
<span class="kw">spec.ls</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/computeSpectraEns.html">computeSpectraEns</a></span>(<span class="kw">t</span>,<span class="kw">X</span>,method = <span class="st">'lomb-scargle'</span>)
<span class="kw">ls.df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="st">"freq"</span> = <span class="kw">spec.ls</span><span class="op">$</span><span class="kw">freqs</span>, <span class="st">"pwr"</span> = <span class="kw">spec.ls</span><span class="op">$</span><span class="kw">power</span>)
<span class="co"># estimate significance against a power-law fit</span>
<span class="kw">f.low</span> <span class="op">&lt;-</span>  <span class="fl">1e-3</span>; <span class="kw">f.high</span> <span class="op">&lt;-</span> <span class="fl">0.1</span>
<span class="kw">plaw.ls</span> <span class="op">&lt;-</span>  <span class="kw">astrochron</span>::<span class="fu"><a href="https://rdrr.io/pkg/astrochron/man/pwrLawFit.html">pwrLawFit</a></span>(<span class="kw">ls.df</span>, dof = <span class="fl">2</span>, flow = <span class="kw">f.low</span>, fhigh = <span class="kw">f.high</span>, output = <span class="fl">1</span>, genplot = <span class="kw">F</span>)

<span class="kw">cl.df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="kw">plaw.ls</span>[,<span class="fu"><a href="https://rdrr.io/pkg/generics/man/setops.html">union</a></span>(<span class="fl">1</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">5</span><span class="op">:</span><span class="fl">7</span>))]) <span class="co"># extract confidence limits</span>
<span class="co"># rename columns to be less silly</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="kw">cl.df</span>)[<span class="fl">1</span>] <span class="op">&lt;-</span> <span class="st">"freq"</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="kw">cl.df</span>)[<span class="fl">2</span>] <span class="op">&lt;-</span> <span class="st">"90% CL"</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="kw">cl.df</span>)[<span class="fl">3</span>] <span class="op">&lt;-</span> <span class="st">"95% CL"</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="kw">cl.df</span>)[<span class="fl">4</span>] <span class="op">&lt;-</span> <span class="st">"99% CL"</span>

<span class="co"># plot this</span>
<span class="kw">pticks</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">10</span>, <span class="fl">20</span>, <span class="fl">50</span>, <span class="fl">100</span>, <span class="fl">200</span>, <span class="fl">500</span>, <span class="fl">1000</span>)
<span class="kw">prange</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">10</span>,<span class="fl">1000</span>)
<span class="kw">yl</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.01</span>,<span class="fl">1000</span>)
<span class="kw">p.ls</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotSpectrum.html">plotSpectrum</a></span>(<span class="kw">ls.df</span>,<span class="kw">cl.df</span>,x.lims = <span class="kw">prange</span>,x.ticks = <span class="kw">pticks</span>, y.lims = <span class="kw">yl</span>,
                     color.line=<span class="st">'orange'</span>, color.cl=<span class="st">'white'</span>) <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span>(<span class="st">"IODP 846 d18O, Lomb-Scargle periodogram"</span>) <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggthemes/man/theme_hc.html">theme_hc</a></span>(style = <span class="st">"darkunica"</span>) <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(axis.ticks.x = <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_line</a></span>(color = <span class="st">"gray"</span>))

<span class="co"># label periodicities of interest</span>
<span class="kw">p.ls</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/periodAnnotate.html">periodAnnotate</a></span>(<span class="kw">p.ls</span>, periods = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">19</span>,<span class="fl">23</span>,<span class="fl">41</span>,<span class="fl">100</span>), y.lims =<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.01</span>,<span class="fl">100</span>))
<span class="fu">show</span>(<span class="kw">p.ls</span>)
</pre></div>
<p><img src="spectral_analysis_files/figure-html/lomb-scargle-1.png" width="768"></p>
<p>It is clearly seen that the data contain significant energy (peaks) near, but not exactly at, the famed Milankovitch periodicities (100, 41, 23, and 19 kyr). These periodicities (particularly the eccentricity (100kyr) and obliquity (40kyr)) rise above the various power law nulls, but we see hints of higher power at high-frequencies. We shall soon see that this is an artifact of the Lomb-Scargle methods, which does not use any tapers and therefore displays high variance (in this context, spurious peaks). Other methods smooth out that noise.</p>
<p><a href="https://boris.unibe.ch/id/eprint/38577">REDFIT</a> does so via application of Welch’s Overlapped Segment Averaging, which by default uses 3 segments that overlap by about 50%. geoChronR uses its <a href="https://cran.r-project.org/web/packages/dplR/index.html">dplR</a> implementation, which differs slightly from the published algorithm (see <code><a href="https://rdrr.io/pkg/dplR/man/redfit.html">?dplR::redfit</a></code> for details).</p>
<div class="sourceCode" id="cb5"><pre class="downlit">
<span class="kw">spec.redfit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/computeSpectraEns.html">computeSpectraEns</a></span>(<span class="kw">t</span>,<span class="kw">X</span>,method = <span class="st">'redfit'</span>)
<span class="kw">redfit.df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="st">"freq"</span> = <span class="kw">spec.redfit</span><span class="op">$</span><span class="kw">freq</span>, <span class="st">"pwr"</span> = <span class="kw">spec.redfit</span><span class="op">$</span><span class="kw">power</span>)
<span class="kw">cl.df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="st">"freq"</span> = <span class="kw">spec.redfit</span><span class="op">$</span><span class="kw">freq</span>, <span class="st">"95% CL"</span> = <span class="kw">spec.redfit</span><span class="op">$</span><span class="kw">power.CL</span>)
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="kw">cl.df</span>)[<span class="fl">2</span>] <span class="op">&lt;-</span> <span class="st">"95% CL"</span>

<span class="co"># plot this</span>
<span class="kw">pticks</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">10</span>, <span class="fl">20</span>, <span class="fl">50</span>, <span class="fl">100</span>, <span class="fl">200</span>, <span class="fl">500</span>, <span class="fl">1000</span>)
<span class="kw">prange</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">10</span>,<span class="fl">1000</span>)
<span class="kw">yl</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.01</span>,<span class="fl">1000</span>)
<span class="kw">p.ls</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotSpectrum.html">plotSpectrum</a></span>(<span class="kw">redfit.df</span>,<span class="kw">cl.df</span>,x.lims=<span class="kw">prange</span>,x.ticks = <span class="kw">pticks</span>, y.lims = <span class="kw">yl</span>,
                     color.line=<span class="st">'orange'</span>, color.cl=<span class="st">'white'</span>) <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span>(<span class="st">"IODP 846 d18O, REDFIT estimation"</span>) <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggthemes/man/theme_hc.html">theme_hc</a></span>(style = <span class="st">"darkunica"</span>) <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(axis.ticks.x = <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_line</a></span>(color = <span class="st">"gray"</span>))

<span class="co"># label periodicities of interest</span>
<span class="kw">p.ls</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/periodAnnotate.html">periodAnnotate</a></span>(<span class="kw">p.ls</span>, periods = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">19</span>,<span class="fl">23</span>,<span class="fl">41</span>,<span class="fl">100</span>), y.lims =<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.01</span>,<span class="fl">100</span>))
<span class="fu">show</span>(<span class="kw">p.ls</span>)
</pre></div>
<p><img src="spectral_analysis_files/figure-html/REDFIT-1.png" width="768"></p>
<p>Now, this clearly is smoother, perhaps a little too much. One could play with <code>n50</code>, the size of the window, or <code>iwin</code>, its shape, to reduce the smoothing. There are still peaks near the Milankovitch periodicities, but in many cases they do not stand out (cf 41 kyr).</p>
</div>
<div id="multi-taper-method" class="section level3">
<h3 class="hasAnchor">
<a href="#multi-taper-method" class="anchor"></a>Multi-taper Method</h3>
<p>The Lomb-Scargle periodogram is a decent way to deal with unevenly-spaced timeseries, but it is still a periodogram, which has several problems. In particular, it is inconsistent: the variance of each estimate goes to infinity as the number of observations increases. A much better estimator is Thomson’s Multi-Taper Method <a href="https://doi.org/10.1109/PROC.1982.12433">Thomson, 1982</a>, which is <a href="https://en.wikipedia.org/wiki/Consistent_estimator">consistent</a> (the more data you have, the better you know the spectrum, as it should be). Formally, MTM optimizes the classic bias-variance tradeoff inherent to all statistical inference. It does so by minimizing leakage outside of a frequency band with half-bandwidth equal to <span class="math inline">\(pf_R\)</span>, where <span class="math inline">\(f_R=1/(N \Delta t)\)</span> is the Rayleigh frequency, <span class="math inline">\(\Delta t\)</span> is the sampling interval, <span class="math inline">\(N\)</span> the number of measurements, and <span class="math inline">\(p\)</span> is the so-called time-bandwidth product. <span class="math inline">\(p\)</span> can only take a finite number of values, all multiples of 1/2 between 2 and 4. A larger <span class="math inline">\(p\)</span> means lower variance (i.e. less uncertainty about the power), but broader peaks (i.e. a lower spectral resolution), synonymous with more uncertainty about the exact location of the harmonic. So while MTM might not distinguish between closely-spaced harmonics, it is much less likely to identify spurious peaks, especially at high frequencies. In addition, a battery of formal tests have been devised with MTM, allowing under reasonably broad assumptions to ascertain the significance of spectral peaks. We show how to use this “harmonic F-test” below.</p>
<p>A notable downside of MTM is that it only handles evenly-spaced data. Small potatoes! As we saw above, the data are not that far from evenly-spaced, so let’s interpolate and see what we get. Conveniently, both the interpolation routine and MTM are available within the <a href="https://www.rdocumentation.org/packages/astrochron">astrochron</a> package.</p>
<div class="sourceCode" id="cb6"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="kw">astrochron</span>)
<span class="kw">dfs</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(time=<span class="kw">t</span>,temp=<span class="kw">X</span>)
<span class="kw">dti</span> <span class="op">=</span> <span class="fl">2.5</span>  <span class="co"># interpolation interval, corresponding to the mode of the \Delta t distribution</span>
<span class="kw">dfe</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/astrochron/man/linterp.html">linterp</a></span>(<span class="kw">dfs</span>,dt=<span class="kw">dti</span>)
</pre></div>
<p><img src="spectral_analysis_files/figure-html/interpolation-1.png" width="768"></p>
<div class="sourceCode" id="cb7"><pre class="downlit">
<span class="kw">tbw</span> <span class="op">=</span> <span class="fl">2</span>  <span class="co">#time-bandwidth product for the analysis; we use the minimum allowed to limit smoothing.</span>
</pre></div>
<p>Most of the <code>astrochron</code> routines produce a diagnostic graphical output, which you can silence by turning the <code>genplot</code> flag to <code>FALSE</code>. However, it is instructive to take a peak at the top-left panel and see where the interpolation has made a difference. We see that the black line closely espouses the red measurements for most of the timeseries, reassuring us that this process did not introduce spurious excursions or oscillations.</p>
<p>Now let’s compute the spectrum using MTM on the equally-spaced data stored in <code>dfe</code>. We continue to manually label Milankovitch frequencies (in orange) and label in green (technically, “chartreuse”) the periodicities identified as significant by the test. Here, we start with the default option of a test against an AR(1) background.</p>
<div class="sourceCode" id="cb8"><pre class="downlit">
<span class="kw">spec.mtm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/computeSpectraEns.html">computeSpectraEns</a></span>(<span class="kw">dfe</span><span class="op">$</span><span class="kw">time</span>,<span class="kw">dfe</span><span class="op">$</span><span class="kw">temp</span>,method = <span class="st">'mtm'</span>, tbw=<span class="kw">tbw</span>) <span class="co"># tbw is the time-bandwidth product, p in the above</span>
<span class="kw">sig.freq</span> <span class="op">&lt;-</span> <span class="kw">astrochron</span>::<span class="fu"><a href="https://rdrr.io/pkg/astrochron/man/mtm.html">mtm</a></span>(<span class="kw">dfe</span>,tbw=<span class="kw">tbw</span>, padfac=<span class="fl">5</span>,ar1=<span class="fl">TRUE</span>,genplot = <span class="kw">F</span>,output=<span class="fl">2</span>, verbose = <span class="kw">F</span>, detrend=<span class="kw">T</span>)
<span class="kw">mtm.df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="st">"freq"</span> = <span class="kw">spec.mtm</span><span class="op">$</span><span class="kw">freqs</span>, <span class="st">"pwr"</span> = <span class="kw">spec.mtm</span><span class="op">$</span><span class="kw">power</span>)

<span class="co"># plot this</span>
<span class="kw">prange</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">5</span>,<span class="fl">1000</span>)

<span class="kw">p.mtm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotSpectrum.html">plotSpectrum</a></span>(<span class="kw">mtm.df</span>,x.lims=<span class="kw">prange</span>,x.ticks = <span class="kw">pticks</span>, y.lims = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1e-6</span>,<span class="fl">10</span>), color.line=<span class="st">'orange'</span>) <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span>(<span class="st">"IODP 846 d18O, Multi-taper method, AR(1) null"</span>) <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span>(<span class="st">"Period (ky)"</span>) <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggthemes/man/theme_hc.html">theme_hc</a></span>(style = <span class="st">"darkunica"</span>) <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(axis.ticks.x = <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_line</a></span>(color = <span class="st">"gray"</span>))

<span class="co"># label periodicities of interest</span>
<span class="kw">p.mtm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/periodAnnotate.html">periodAnnotate</a></span>(<span class="kw">p.mtm</span>, periods = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">19</span>,<span class="fl">23</span>,<span class="fl">41</span>,<span class="fl">100</span>), y.lims = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1e-6</span>,<span class="fl">1</span>))
<span class="kw">p.mtm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/periodAnnotate.html">periodAnnotate</a></span>(<span class="kw">p.mtm</span>, periods = <span class="fl">1</span><span class="op">/</span><span class="kw">sig.freq</span><span class="op">$</span><span class="kw">Frequency</span>,color = <span class="st">"chartreuse"</span>,y.lims = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1e-6</span>,<span class="fl">.1</span>))
<span class="fu">show</span>(<span class="kw">p.mtm</span>)
</pre></div>
<p><img src="spectral_analysis_files/figure-html/MTM-1.png" width="768"></p>
<p>You may notice a few differences to the Lomb-Scargle periodogram. First, the high frequency part is much smoother, getting rid of a lot of high-frequency noise. There is also a clear power law behavior from periods of 5 to 100 ky, which in this log-log plotting convention manifests as a linear decrease. <em>Astrochron</em> implements several tests to detect harmonic (sinusoidal) components. Like all tests, they are heavily dependent on a null hypothesis. By default, <em>astrochron::mtm()</em> assumes that we test against an AR(1) model. Using the option <code>output = 2</code>, it will export the frequencies identified as “significant” by this procedure. In this case, it roughly identifies the Milankovitch frequencies we expected to find, plus many others. What should we make of that? The 100ka cycle is now labeled as 90 ka, though given the peak’s width, one should not be foolish enough to consider them distinct. There is also evidence that this peak may be the result of ice ages clustering every 2 to 3 obliquity cycles (81 or 123 ka), averaging around 100 over the pleistocene <a href="https://www.nature.com/articles/nature03401">Huybers &amp; Wunsch (2005)</a>. Bottom line: with such spectral resolution, 94 and 100 are one and the same, and may really be a mixture of 80 and 120. Overall, this test identifies 8 periodicities as significant, compared to the 4 we’d expect.</p>
<p>It’s helpful to take a step back and contemplate our null hypothesis of AR(1) background, and the real possibility that without adjustments, we might be underestimating the lag-1 autocorrelation, hence making the test too lenient. There are alternatives to that in <em>Astrochron</em>, using either the robust method of <a href="https://link.springer.com/article/10.1007/BF00142586">Mann &amp; Lees (1996)</a> or a less error-prone version by the author <a href="https://agupubs.onlinelibrary.wiley.com/doi/full/10.1029/2012PA002307">Meyers, (2012)</a>, called LOWSPEC. You might want to experiment with that.</p>
<p>Another factor to play with is the padding factor (<code>padfac</code>). In a nutshell, padding helps increase the spectral resolution at little to no cost (see <a href="https://dsp.stackexchange.com/questions/741/why-should-i-zero-pad-a-signal-before-taking-the-fourier-transform">here</a> for an informal account). You should also try and see what happens when it varies. (note: we used the <em>Astrochron</em> default values here)</p>
<p>Most important of all is the choice of null <a href="https://agupubs.onlinelibrary.wiley.com/doi/full/10.1029/2011PA002195">(Vaughan et al, 2011)</a>. Past work has shown that the continuum of climate variability is well described by power laws <a href="https://www.nature.com/articles/nature04745">Huybers &amp; Curry (2006)</a>, so this should be a far better null against which to test the emergence of spectral peaks. Never fear! <em>Astrochron</em> has an app for that:</p>
<div class="sourceCode" id="cb9"><pre class="downlit">
<span class="kw">mtmPL.df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/computeSpectraEns.html">computeSpectraEns</a></span>(<span class="kw">t</span>,<span class="kw">X</span>,method = <span class="st">'mtm'</span>, tbw=<span class="kw">tbw</span>, mtm_null = <span class="st">'power_law'</span>) <span class="co"># tbw is the time-bandwidth product, p in the above</span>
<span class="kw">sig.freqPL</span> <span class="op">&lt;-</span> <span class="kw">astrochron</span>::<span class="fu"><a href="https://rdrr.io/pkg/astrochron/man/mtmPL.html">mtmPL</a></span>(<span class="kw">dfe</span>,tbw=<span class="kw">tbw</span>,padfac=<span class="fl">5</span>,genplot = <span class="kw">F</span>,output=<span class="fl">2</span>, verbose = <span class="kw">F</span>, flow=<span class="kw">f.low</span>, fhigh=<span class="kw">f.high</span>)
<span class="kw">mtm.df</span> <span class="op">=</span> <span class="kw">mtmPL.df</span>[<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">2</span>)]
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="kw">mtm.df</span>)[<span class="fl">1</span>] <span class="op">&lt;-</span> <span class="st">"freq"</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="kw">mtm.df</span>)[<span class="fl">2</span>] <span class="op">&lt;-</span> <span class="st">"pwr"</span>

<span class="kw">cl.df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="kw">mtmPL.df</span><span class="op">$</span><span class="kw">freqs</span>,<span class="kw">mtmPL.df</span><span class="op">$</span><span class="kw">power.CL</span>) <span class="co"># extract confidence limits</span>
<span class="co"># rename columns to be less silly</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="kw">cl.df</span>)[<span class="fl">1</span>] <span class="op">&lt;-</span> <span class="st">"freq"</span>
<span class="co">#names(cl.df)[2] &lt;- "90% CL"</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="kw">cl.df</span>)[<span class="fl">2</span>] <span class="op">&lt;-</span> <span class="st">"95% CL"</span>
<span class="co">#names(cl.df)[4] &lt;- "99% CL"</span>


<span class="co"># plot it</span>
<span class="kw">p.mtmPL</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotSpectrum.html">plotSpectrum</a></span>(<span class="kw">mtm.df</span>,<span class="kw">cl.df</span>,x.lims = <span class="kw">prange</span>,x.ticks = <span class="kw">pticks</span>,
                        y.lims = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1e-6</span>,<span class="fl">10</span>),color.line=<span class="st">'orange'</span>, color.cl=<span class="st">'white'</span>) <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span>(<span class="st">"IODP 846 d18O, Multi-taper method, power-law null"</span>) <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span>(<span class="st">"Period (ky)"</span>) <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggthemes/man/theme_hc.html">theme_hc</a></span>(style = <span class="st">"darkunica"</span>) <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(axis.ticks.x = <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_line</a></span>(color = <span class="st">"gray"</span>))

<span class="co"># label periodicities of interest</span>
<span class="kw">p.mtmPL</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/periodAnnotate.html">periodAnnotate</a></span>(<span class="kw">p.mtmPL</span>, periods = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">19</span>,<span class="fl">23</span>,<span class="fl">41</span>,<span class="fl">100</span>), y.lims = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1e-6</span>,<span class="fl">1</span>))
<span class="kw">p.mtmPL</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/periodAnnotate.html">periodAnnotate</a></span>(<span class="kw">p.mtmPL</span>, periods = <span class="fl">1</span><span class="op">/</span><span class="kw">sig.freqPL</span><span class="op">$</span><span class="kw">Frequency</span>,color = <span class="st">"chartreuse"</span>,y.lims = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1e-6</span>,<span class="fl">.1</span>))
<span class="fu">show</span>(<span class="kw">p.mtmPL</span>)
</pre></div>
<p><img src="spectral_analysis_files/figure-html/unnamed-chunk-4-1.png" width="768"></p>
<p>Sure enough, this gets rid of a few cycles, but many remain. A few regions of the spectrum poke above the 95% confidence limit, but one should not be so foolish as to identify every single periodicity in these ranges to be independent. This is related to the <a href="https://en.wikipedia.org/wiki/Multiple_comparisons_problem">multiple hypothesis problem</a>. However, as pointed out by <a href="https://agupubs.onlinelibrary.wiley.com/doi/full/10.1029/2012PA002307">Meyers, (2012)</a>, even that misses the point: sedimentary processes (and many processes in other proxy archives) tend to smooth out the signal over the depth axis (hence, over time), making comparisons at neighboring frequencies highly dependent. One solution is to use predictions made by a physical model about the frequency and relative amplitude of astronomical cycles <a href="http://www.ajsonline.org/content/307/5/773">Meyers &amp; Sageman, 2007</a>. However this may not be applicable to all spectral detection problems. We thus refrain from implementing “cookie-cutter” solutions in GeoChronR, to force the user to think deeply about the null hypothesis and the most sensible way to test it.</p>
</div>
<div id="weighted-wavelet-z-transform-nuspectral" class="section level3">
<h3 class="hasAnchor">
<a href="#weighted-wavelet-z-transform-nuspectral" class="anchor"></a>Weighted Wavelet Z-transform (<em>nuspectral</em>)</h3>
<p>An interpolation-free alternative to MTM is the Weighted Wavelet Z-transform of <a href="http://adsabs.harvard.edu/cgi-bin/bib_query?1996AJ....112.1709F">Foster, (1996)</a>. The idea of spectral analysis is to decompose the signal on an orthogonal basis of sines and cosines. Data gaps cause this basis to lose its orthogonality, creating energy leakage. WWZ mitigates this problem using an inverse approach. Because it is wavelet based, it does not rely on interpolation or detrending. WWZ was adapted by <a href="https://www.pnas.org/content/110/30/12213.short">Kirchner &amp; Neal (2013)</a>, who employed basis rotations to mitigate the numerical instability that occurs in pathological cases with the original algorithm. A paleoclimate example of its use is given in <a href="https://www.pnas.org/content/116/18/8728.short">Zhu et al (2019)</a>).</p>
<p>The WWZ method has one adjustable parameter, a decay constant that balances the time resolution and frequency resolution of the wavelet analysis. The smaller this constant is, the sharper the peaks.</p>
<p>We wanted to offer GeoChronR users a better alternative to Lom-Scargle, but the WWZ code is relatively complex. We thus chose to incoporate the <em>nuspectral</em> method of <a href="https://www.jstatsoft.org/article/view/v011i02">Mathias et al (2004)</a> based on a similar idea. However, it is not equivalent to WWZ. The main difference has to do with the approximation of the mother wavelet by a cubic polynomial with compact support. This speeds up computation at the cost of much accuracy. <a href="https://www.jstatsoft.org/article/view/v011i02">Mathias et al (2004)</a> also describe implementations of complex wavelets in C (a compiled language, faster with loops), but we were not able to obtain any sensible results with those. For now, it is incorporated into GeoChronR to encourage further development.</p>
<p>First, you’ll need to make sure you have nuspectral installed, as it’s not yet automatically installed with GeoChronR</p>
<div class="sourceCode" id="cb10"><pre class="downlit">
<span class="co">if</span>(<span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html">requireNamespace</a></span>(<span class="st">"nuspectral"</span>,quietly = <span class="fl">TRUE</span>)){<span class="co">#see if nuspectral is already installed</span>
  <span class="kw">remotes</span>::<span class="fu"><a href="https://rdrr.io/pkg/remotes/man/install_github.html">install_github</a></span>(<span class="st">"nickmckay/nuspectral"</span>) <span class="co">#install nuspectral if needed</span>
}
</pre></div>
<p>Let us see how it performs in on IODP846.</p>
<div class="sourceCode" id="cb11"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/ns-load.html">requireNamespace</a></span>(<span class="st">"nuspectral"</span>, quietly = <span class="fl">TRUE</span>)
<span class="kw">nt</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="kw">t</span>)
<span class="kw">tau</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span>(<span class="kw">t</span>),<span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span>(<span class="kw">t</span>),length = <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span>(<span class="kw">nt</span> <span class="op">%/%</span> <span class="fl">2</span>,<span class="fl">5</span>))
<span class="kw">nuspec</span> <span class="op">&lt;-</span>  <span class="kw">nuspectral</span>:::<span class="fu"><a href="https://rdrr.io/pkg/nuspectral/man/nuwavelet_psd.html">nuwavelet_psd</a></span>(<span class="kw">t</span>,<span class="kw">X</span>,sigma=<span class="fl">0.01</span>,taus = <span class="kw">tau</span>)
<span class="kw">nf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="kw">nuspec</span><span class="op">$</span><span class="kw">Frequency</span>)
<span class="kw">nus.df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="st">"freq"</span> = <span class="kw">nuspec</span><span class="op">$</span><span class="kw">Frequency</span>, <span class="st">"pwr"</span> = <span class="kw">nuspec</span><span class="op">$</span><span class="kw">Power</span>)

<span class="co"># power law fit</span>
<span class="kw">plaw.fit</span> <span class="op">=</span> <span class="kw">astrochron</span>::<span class="fu"><a href="https://rdrr.io/pkg/astrochron/man/pwrLawFit.html">pwrLawFit</a></span>(<span class="kw">nus.df</span>, dof = <span class="fl">2</span>, flow = <span class="fl">0.001</span>, fhigh = <span class="fl">0.1</span>, output = <span class="fl">1</span>, genplot = <span class="kw">F</span>)
<span class="kw">cl.df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="kw">plaw.fit</span>[,<span class="fu"><a href="https://rdrr.io/pkg/generics/man/setops.html">union</a></span>(<span class="fl">1</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">5</span><span class="op">:</span><span class="fl">7</span>))]) <span class="co"># extract confidence limits</span>
<span class="co"># rename columns to be less silly</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="kw">cl.df</span>)[<span class="fl">1</span>] <span class="op">&lt;-</span> <span class="st">"freq"</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="kw">cl.df</span>)[<span class="fl">2</span>] <span class="op">&lt;-</span> <span class="st">"90% CL"</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="kw">cl.df</span>)[<span class="fl">3</span>] <span class="op">&lt;-</span> <span class="st">"95% CL"</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="kw">cl.df</span>)[<span class="fl">4</span>] <span class="op">&lt;-</span> <span class="st">"99% CL"</span>
</pre></div>
<p>Compared to the previous methods, which were essentially instantaneous on this dataset, this took a few seconds. Keep that in mind for large ensembles, because if you start adding up 1000’s of seconds, pretty soon you’re waiting for an hour.</p>
<p>As before, we leverage <em>astrochron</em>’s capabilities to fit a power-law to the spectrum. The power law comes out with a slope around 1, as before.</p>
<div class="sourceCode" id="cb12"><pre class="downlit">
<span class="kw">p.nus</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotSpectrum.html">plotSpectrum</a></span>(<span class="kw">nus.df</span>,<span class="kw">cl.df</span>,
                      x.lim=<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">10</span>,<span class="fl">1000</span>),
                      x.ticks = <span class="kw">pticks</span>,
                      y.lims = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.1</span>,<span class="fl">300</span>),
                      color.line=<span class="st">'orange'</span>,
                      color.cl=<span class="st">'white'</span>) <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span>(<span class="st">"IODP 846 d18O, nuspectral periodogram"</span>) <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggthemes/man/theme_hc.html">theme_hc</a></span>(style = <span class="st">"darkunica"</span>) <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(axis.ticks.x = <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_line</a></span>(color = <span class="st">"gray"</span>))

<span class="co"># label periodicities of interest</span>
<span class="kw">p.nus</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/periodAnnotate.html">periodAnnotate</a></span>(<span class="kw">p.nus</span>, periods = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">19</span>,<span class="fl">23</span>,<span class="fl">41</span>,<span class="fl">100</span>),y.lims = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.1</span>,<span class="fl">100</span>))
<span class="fu">show</span>(<span class="kw">p.nus</span>)
</pre></div>
<p><img src="spectral_analysis_files/figure-html/nuspectral%20plotting-1.png" width="768"></p>
<p>Broadly speaking, we see evidence for the same periodicities, but this took some fiddling with the <span class="math inline">\(\sigma\)</span> parameter ; the default (0.05) would have overly damped the peaks. We note that this default value is not backed by good theoretical arguments or Monte Carlo simulation – undoubtedly a weakness of this method. Also notable is that the confidence limits affect peak detection very differently here; only the eccentricity cycle near 100ky rises above the 95% and 99% levels; other cycles are summarily dismissed. This could be a result of assuming two degrees of freedom (DOFs) at each frequency, which is most likely violated with wavelets. Internally, <code>nuwavelet_psd</code> does use variable DOFs, but this is not easy to export. You can tweak the range over which this power law is fit and it will not change the story much.</p>
<p>Readers interested in a more robust implementation of WWZ may want to consider <a href="http://linkedearth.github.io/Pyleoclim_util/Introduction.html">pyleoclim</a>, a Python package. This can be called in R via the <a href="https://rstudio.github.io/reticulate/">Reticulate</a> package.</p>
</div>
<div id="time-uncertain-spectral-analysis" class="section level2">
<h2 class="hasAnchor">
<a href="#time-uncertain-spectral-analysis" class="anchor"></a>Time-uncertain spectral analysis</h2>
<p>Now let’s consider age uncertainties.</p>
<p>The GeoChronR approach to quantifying and propagating those uncertainties is to leverage the power of ensembles. Here we will illustrate this with MTM. Let us repeat the previous analysis by looping over the 1,000 age realizations output by the tuning algorithm HMM-Match. That means computing 1000 spectra. We’ve already seen that <em>nuspectral</em> is too slow for an ensemble job, so let’s leave it out. Also, since REDFIT is a tapered version of Lomb-Scargle, and comes with more features, let’s focus here on comparing an REDFIT and MTM in ensemble mode.</p>
<div class="sourceCode" id="cb13"><pre class="downlit">
<span class="kw">time</span> <span class="op">=</span> <span class="kw">age</span><span class="op">$</span><span class="kw">values</span>[<span class="kw">age.median</span> <span class="op">&lt;</span> <span class="fl">1000</span>,]  <span class="co"># age ensemble for ~ last 1 Ma</span>
<span class="kw">values</span> <span class="op">=</span> <span class="kw">temp</span><span class="op">$</span><span class="kw">values</span>[<span class="kw">age.median</span> <span class="op">&lt;</span> <span class="fl">1000</span>]
<span class="kw">mtm.ens.spec</span> <span class="op">=</span> <span class="fu"><a href="../reference/computeSpectraEns.html">computeSpectraEns</a></span>(<span class="kw">time</span>,<span class="kw">values</span>,
                                 max.ens = <span class="fl">1000</span>,
                                 method = <span class="st">'mtm'</span>,
                                 tbw=<span class="kw">tbw</span>, padfac=<span class="fl">5</span>,
                                 mtm_null = <span class="st">'AR(1)'</span>)
</pre></div>
<p>This took a few seconds with 1000 ensemble members, and the resulting output is close to 10 Mb. Not an issue for modern computers, but you can see why people weren’t doing this in the 70’s, even if they wanted to. Now, let’s plot the result:</p>
<div class="sourceCode" id="cb14"><pre class="downlit">
<span class="kw">ar1.df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="kw">mtm.ens.spec</span><span class="op">$</span><span class="kw">freqs</span>,<span class="kw">mtm.ens.spec</span><span class="op">$</span><span class="kw">power.CL</span>)
<span class="co"># rename columns to be less silly</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="kw">ar1.df</span>)[<span class="fl">1</span>] <span class="op">&lt;-</span> <span class="st">"freq"</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="kw">ar1.df</span>)[<span class="fl">2</span>] <span class="op">&lt;-</span> <span class="st">"95% CL"</span>

<span class="kw">p.mtm.ens</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotSpectraEns.html">plotSpectraEns</a></span>(spec.ens = <span class="kw">mtm.ens.spec</span>, cl.df = <span class="kw">ar1.df</span>, x.lims = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">10</span>,<span class="fl">150</span>), y.lims = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1e-5</span>,<span class="fl">1e-1</span>),
                            color.line=<span class="st">'darkorange'</span>,
                            color.low=<span class="st">'darkorange2'</span>,
                            color.high=<span class="st">'coral4'</span>,color.cl = <span class="st">'white'</span>) <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span>(<span class="st">"IODP 846 age ensemble, MTM"</span>) <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/ggthemes/man/theme_hc.html">theme_hc</a></span>(style = <span class="st">"darkunica"</span>) <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(axis.ticks.x = <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_line</a></span>(color = <span class="st">"gray"</span>))

<span class="co"># label periodicities of interest</span>
<span class="kw">p.mtm.ens</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/periodAnnotate.html">periodAnnotate</a></span>(<span class="kw">p.mtm.ens</span>, periods = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">19</span>,<span class="fl">23</span>,<span class="fl">41</span>,<span class="fl">100</span>), y.lims =<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.01</span>,<span class="fl">0.05</span>))
<span class="fu">show</span>(<span class="kw">p.mtm.ens</span>)
</pre></div>
<p><img src="spectral_analysis_files/figure-html/ensemble-mode%20MTM,%20plot-1.png" width="768"></p>
<p>To this we can add the periods identified as significant owing to MTM’s harmonic ratio test. geoChronR deals with it by computing at each frequency the fraction of ensemble members that exhibit a significant peak. One simple criterion for gauging the level of support for such peaks given age uncertainties is to pick out those periodicities that are identified as significant more than 50% of the time.</p>
<div class="sourceCode" id="cb15"><pre class="downlit">
<span class="kw">per</span> <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="kw">cl.df</span><span class="op">$</span><span class="kw">freq</span>
<span class="kw">sig_per</span> <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span>(<span class="kw">mtm.ens.spec</span><span class="op">$</span><span class="kw">sig.freq</span><span class="op">&gt;</span><span class="fl">0.5</span>)
<span class="kw">p.mtm.ens</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/periodAnnotate.html">periodAnnotate</a></span>(<span class="kw">p.mtm.ens</span>, periods = <span class="kw">per</span>[<span class="kw">sig_per</span>],color = <span class="st">"chartreuse"</span>,y.lims = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1e-5</span>,<span class="fl">5e-4</span>))
<span class="fu">show</span>(<span class="kw">p.mtm.ens</span>)
</pre></div>
<p><img src="spectral_analysis_files/figure-html/MTM%20ensemble,%20with%20significant%20frequencies-1.png" width="768"></p>
<p>One could of course, impose a more stringent criterion (e.g. 80%, 90%, etc). To do that, specify <code><a href="https://rdrr.io/r/base/which.html">which(mtm.ens.spec$sig.freq&gt;0.8)</a></code> or <code><a href="https://rdrr.io/r/base/which.html">which(mtm.ens.spec$sig.freq&gt;0.9)</a></code>. That relatively close peaks appear significant may be an artifact of neglecting the multiple hypothesis problem (cf Vaughan et al, 2011).</p>
<p>So what do we find? Consistent with previous investigations (e.g. <a href="https://npg.copernicus.org/articles/16/43/2009/">Mudelsee et al 2009</a>), the effect of age uncertainties is felt more at high frequencies, with the effect of broadening peaks, or lumping them together. Again, the peaks that rise above the power-law background are the ~100kyr and ~40kyr peaks, which is not surprising. There is significant energy around the precessional peaks, but it is rather spread out, and hard to tie to particular harmonics. No doubt a record with higher-resolution and/or tighter chronology would show sharper precessional peaks.</p>
<p>Do we get the same answer in REDFIT? Let’s find out.</p>
<div class="sourceCode" id="cb16"><pre class="downlit">
<span class="kw">spec.redfit.ens</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/computeSpectraEns.html">computeSpectraEns</a></span>(<span class="kw">time</span>,<span class="kw">values</span>,max.ens = <span class="fl">1000</span>, method = <span class="st">'redfit'</span>)
<span class="kw">cl.ens.df</span>     <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="st">"freq"</span> = <span class="kw">spec.redfit.ens</span><span class="op">$</span><span class="kw">freq</span>, <span class="st">"pwr95"</span> = <span class="kw">spec.redfit.ens</span><span class="op">$</span><span class="kw">power.CL</span>) <span class="co"># store confidence limits</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="kw">cl.ens.df</span>)[<span class="fl">2</span>] <span class="op">&lt;-</span> <span class="st">"95% CL"</span>
</pre></div>
<p>again, it took a bit of time. let’s plot the result:</p>
<div class="sourceCode" id="cb17"><pre class="downlit">
<span class="kw">p.redfit.ens</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotSpectraEns.html">plotSpectraEns</a></span>(spec.ens = <span class="kw">spec.redfit.ens</span>,
                               cl.df = <span class="kw">cl.ens.df</span>,
                               x.lims = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">10</span>,<span class="fl">150</span>),
                               color.line=<span class="st">'darkorange'</span>,
                               color.low=<span class="st">'darkorange2'</span>,
                               color.high=<span class="st">'coral4'</span>,
                               color.cl = <span class="st">'white'</span>) <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span>(<span class="st">"IODP 846 age ensemble, redfit"</span>) <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggthemes/man/theme_hc.html">theme_hc</a></span>(style = <span class="st">"darkunica"</span>) <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(axis.ticks.x = <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_line</a></span>(color = <span class="st">"gray"</span>))

<span class="co"># label periodicities of interest</span>
<span class="kw">p.redfit.ens</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/periodAnnotate.html">periodAnnotate</a></span>(<span class="kw">p.redfit.ens</span>, periods = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">19</span>,<span class="fl">23</span>,<span class="fl">41</span>,<span class="fl">100</span>), y.lims =<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.01</span>,<span class="fl">500</span>))
<span class="fu">show</span>(<span class="kw">p.redfit.ens</span>)
</pre></div>
<p><img src="spectral_analysis_files/figure-html/ensemble-mode%20REDFIT%20plot-1.png" width="768"></p>
<p>The result is quite a bit smoother here, perhaps because of the choice of parameters.</p>
</div>
</div>
<div id="conclusion" class="section level1">
<h1 class="hasAnchor">
<a href="#conclusion" class="anchor"></a>Conclusion</h1>
<p>There are several takeaways from this example:</p>
<ol style="list-style-type: decimal">
<li>geoChronR implements 4 different spectral methods, with different features and assumptions. This allows users to explore whether results obtained with one method are robust to these choices.<br>
</li>
<li>The methods are enabled for single age models, as well as age ensembles.</li>
<li>The choice of null hypothesis is always highly consequential, and should be made with care.</li>
<li>Hunting for astronomical (or other) frequencies in paleoclimate timeseries takes extreme care, and cannot be answered in one function call. In this particular example where the data are nearly evenly spaced, and interpolation has a negligible impact, the best choice is MTM for two reasons: (1) because it is optimal, in the sense that it minimizes spectral leakage, and (2) because the implementation used here (derived from <em>astrochron</em>) allows to flexibly apply different tests of significance. Not such luxury is afforded by the other methods at present.</li>
<li>There is no one-size-fits-all method that will solve your exact problem, but it might get you started on asking relevant questions. Readers are invited to consider <a href="https://doi.org/10.1029/2011PA002195">Vaughan et al, 2011</a> and the work of Stephen Meyers on this topic:</li>
</ol>
<ul>
<li><a href="https://doi.org/10.1029/2012PA002307">Meyers, 2012</a></li>
<li><a href="https://agupubs.onlinelibrary.wiley.com/doi/full/10.1002/2015PA002850">Meyers, 2015</a></li>
<li><a href="www.pnas.org/cgi/doi/10.1073/pnas.1717689115">Meyers &amp; Malinverno 2018</a></li>
</ul>
<p><a href="PCA.html">In the final tutorial vignette</a>, we perform ensemble Principal Components Analysis on multiple sites in the North Atlantic.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Nicholas McKay, Julien Emile-Geay, Deborah Khider.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: '21c1c99b27cf4a45be9f8db70183f6c7',
    indexName: 'lipd-utilities',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
